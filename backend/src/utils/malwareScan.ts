import fs from 'fs/promises';

const dangerousKeywords = ['rm -rf', 'eval', 'bitcoin'];

export async function scanFileForMalware(path: string): Promise<'clean'|'infected'> {
  const content = await fs.readFile(path);
  const text = content.toString('utf8').toLowerCase();

  for(const keyword of dangerousKeywords) {
    if(text.includes(keyword)) return 'infected';
  }
  return 'clean';
}
